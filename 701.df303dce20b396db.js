"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[701],{7701:(z,f,s)=>{s.r(f),s.d(f,{DashboardModule:()=>$});var h=s(6814),T=s(95),Z=s(9252),A=s(1122),u=s(6623),v=s(707),U=s(1913),y=s(74),b=s(7403),C=s(4352),_=s(9360),q=s(8251),t=s(5849),D=s(981),S=s(3859),M=s(1563),w=s(1850),I=s(5219),x=s(7213);function J(i,c){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Usuario"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Imagen"),t.qZA(),t.TgZ(5,"th",28),t._uU(6,"Fecha "),t._UZ(7,"p-sortIcon",29),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Prediccion"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Ver"),t.qZA()())}function O(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",30),t._UZ(4,"img",31),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"button",32),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.showDetails(a))}),t.qZA()()()}if(2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Q6J("src",e.image_url,t.LSH),t.xp6(2),t.Oqu(e.timestamp),t.xp6(2),t.Oqu(e.predictions)}}function F(i,c){1&i&&(t.TgZ(0,"div",33)(1,"p",34),t._uU(2,"No hay datos reales, pero aqu\xed tienes un gr\xe1fico vac\xedo."),t.qZA()())}function j(i,c){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Usuario"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Imagen"),t.qZA(),t.TgZ(5,"th",28),t._uU(6,"Fecha "),t._UZ(7,"p-sortIcon",29),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Prediccion"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Ver"),t.qZA()())}function E(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",30),t._UZ(4,"img",31),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"button",32),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.showDetails(a))}),t.qZA()()()}if(2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Q6J("src",e.image_url,t.LSH),t.xp6(2),t.Oqu(e.timestamp),t.xp6(2),t.Oqu(e.predictions)}}function Q(i,c){if(1&i&&(t.TgZ(0,"div")(1,"p")(2,"strong"),t._uU(3,"Usuario:"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"strong"),t._uU(7,"Fecha:"),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"p")(10,"strong"),t._uU(11,"Predicci\xf3n:"),t.qZA(),t._uU(12),t.qZA(),t._UZ(13,"img",36),t.qZA()),2&i){const e=t.oxw(2);t.xp6(4),t.hij(" ",e.selectedPrediction.nombre,""),t.xp6(4),t.hij(" ",e.selectedPrediction.timestamp,""),t.xp6(4),t.hij(" ",e.selectedPrediction.predictions,""),t.xp6(1),t.Q6J("src",e.selectedPrediction.image_url,t.LSH)}}function N(i,c){if(1&i&&t.YNc(0,Q,14,4,"div",35),2&i){const e=t.oxw();t.Q6J("ngIf",e.selectedPrediction)}}const g=()=>({width:"2.5rem",height:"2.5rem"});let B=(()=>{class i{constructor(e,o,n,a){this.productService=e,this.layoutService=o,this.predictionService=n,this.authService=a,this.recentPredictions=[],this.allPredictions=[],this.displayModal=!1,this.insufficientData=!1,this.selectedPrediction=null,this.user=null,this.authService.isAuthenticated$.subscribe(r=>{this.user=this.authService.getUser()}),this.subscription=this.layoutService.configUpdate$.pipe(function P(i,c=C.z){return(0,_.e)((e,o)=>{let n=null,a=null,r=null;const d=()=>{if(n){n.unsubscribe(),n=null;const l=a;a=null,o.next(l)}};function m(){const l=r+i,p=c.now();if(p<l)return n=this.schedule(void 0,l-p),void o.add(n);d()}e.subscribe((0,q.x)(o,l=>{a=l,r=c.now(),n||(n=c.schedule(m,i),o.add(n))},()=>{d(),o.complete()},void 0,()=>{a=n=null}))})}(25)).subscribe(r=>{this.initChart()})}ngOnInit(){this.initChart(),this.loadRecentPredictions(),this.getAllPredictions(),this.productService.getProductsSmall().then(e=>this.products=e),this.loadCategoryData(),this.items=[{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}],console.log("Usuario",localStorage.getItem("user"))}initChart(){const e=getComputedStyle(document.documentElement);e.getPropertyValue("--text-color"),e.getPropertyValue("--text-color-secondary"),e.getPropertyValue("--surface-border"),this.chartData={labels:[],datasets:[{data:[],backgroundColor:[]}]},this.chartOptions={}}loadCategoryData(){const e=localStorage.getItem("user_id")||"1";this.predictionService.getPredictionsGrafico(e).subscribe(o=>{const a={};let r=0;o.predictions.forEach(l=>{l.predictions.forEach(p=>{a[p]=(a[p]||0)+1,r++})});const d=Object.keys(a),m=Object.values(a).map(l=>l/r*100);this.chartData=0===d.length?{labels:["Sin datos"],datasets:[{data:[100],backgroundColor:["#d3d3d3"]}]}:{labels:d,datasets:[{data:m,backgroundColor:["#36A2EB","#FF6384","#4BC0C0","#FF9F40","#40ff7d","#bc40ff","#f6ff40","#404cff","#00c40f","#c40000","#c49a00","#7d40ff","#ff4040","#40d0ff","#ff404c","#ffac40","#40c9ff","#ff7b40","#ff00d0","#d040ff","#40ffb0","#40ff8a","#ffc140","#d0ff40","#ff573f","#ff7040","#40c8ff","#ff0040","#6f40ff","#ff80e0","#ffbd40","#bbff40","#ff6050","#40ffd9","#ff7a40","#ff40b0"]}]},this.chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{boxWidth:6,padding:6,font:{size:11}}},tooltip:{callbacks:{label:function(l){return l.raw.toFixed(2)+"%"}}}}}},o=>{console.error("Error fetching predictions:",o),this.insufficientData=!0})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}loadRecentPredictions(){if(this.userId=localStorage.getItem("user"),this.userId){const o=JSON.parse(this.userId).id;this.predictionService.getRecentPredictions(o).subscribe(n=>{this.recentPredictions=n.predictions},n=>{console.error("Error fetching recent predictions:",n)})}}viewPrediction(e){this.selectedProduct=e,this.displayModal=!0}getAllPredictions(){this.predictionService.getAllPredictions().subscribe(e=>{this.allPredictions=e.predictions},e=>{console.error("Error al obtener todas las predicciones:",e)})}showDetails(e){this.selectedPrediction=e,this.displayModal=!0}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(D.M),t.Y36(S.P),t.Y36(M.p),t.Y36(w.e))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["ng-component"]],decls:80,vars:23,consts:[[1,"grid"],[1,"col-12","lg:col-6","xl:col-3"],[1,"card","mb-0"],[1,"flex","justify-content-between","mb-3"],[1,"block","text-500","font-medium","mb-3"],[1,"text-900","font-medium","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-blue-100","border-round",3,"ngStyle"],[1,"pi","pi-shopping-cart","text-blue-500","text-xl"],[1,"text-green-500","font-medium"],[1,"text-500"],[1,"flex","align-items-center","justify-content-center","bg-orange-100","border-round",3,"ngStyle"],[1,"pi","pi-map-marker","text-orange-500","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-cyan-100","border-round",3,"ngStyle"],[1,"pi","pi-inbox","text-cyan-500","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-purple-100","border-round",3,"ngStyle"],[1,"pi","pi-comment","text-purple-500","text-xl"],[1,"col-12","xl:col-6"],[1,"card"],["responsiveLayout","scroll",3,"value","paginator","rows"],["pTemplate","header"],["pTemplate","body"],["class","text-center",4,"ngIf"],[1,"chart-wrapper",2,"width","100%","height","400px","overflow-y","auto"],["type","doughnut",3,"data","options"],[1,"card","flex","flex-column","md:flex-row","align-items-center","justify-content-center","gap-5"],["src","assets/demo/images/galleria/precision.png","alt","Precision",1,"w-full","md:w-6","md:h-auto"],[3,"visible","header","modal","closable","responsive","visibleChange"],["pTemplate","content"],["pSortableColumn","timestamp"],["field","timestamp"],[2,"width","15%","min-width","5rem"],["alt","Predicci\xf3n","width","50",1,"shadow-4",3,"src"],["pButton","","pRipple","","type","button","icon","pi pi-search",1,"p-button","p-component","p-button-text","p-button-icon-only",3,"click"],[1,"text-center"],[1,"text-red-500","font-bold"],[4,"ngIf"],["alt","Imagen de la predicci\xf3n",2,"width","100%","height","auto",3,"src"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"span",4),t._uU(6,"Modelo de alta prediccion"),t.qZA(),t.TgZ(7,"div",5),t._uU(8,"+0.75 Acuraccy"),t.qZA()(),t.TgZ(9,"div",6),t._UZ(10,"i",7),t.qZA()(),t.TgZ(11,"span",8),t._uU(12,"80% "),t.qZA(),t.TgZ(13,"span",9),t._uU(14,"Predicciones exitosas"),t.qZA()()(),t.TgZ(15,"div",1)(16,"div",2)(17,"div",3)(18,"div")(19,"span",4),t._uU(20,"Modelo optimizado"),t.qZA(),t.TgZ(21,"div",5),t._uU(22,"200MB de peso total"),t.qZA()(),t.TgZ(23,"div",10),t._UZ(24,"i",11),t.qZA()()()(),t.TgZ(25,"div",1)(26,"div",2)(27,"div",3)(28,"div")(29,"span",4),t._uU(30,"Diversidad de imagenes"),t.qZA(),t.TgZ(31,"div",5),t._uU(32,"Dataset completo"),t.qZA()(),t.TgZ(33,"div",12),t._UZ(34,"i",13),t.qZA()(),t.TgZ(35,"span",8),t._uU(36,"+380k "),t.qZA(),t.TgZ(37,"span",9),t._uU(38,"Imagenes de entrenamiento"),t.qZA()()(),t.TgZ(39,"div",1)(40,"div",2)(41,"div",3)(42,"div")(43,"span",4),t._uU(44,"Modelo escalable"),t.qZA(),t.TgZ(45,"div",5),t._uU(46,"Se puede mejorar su prediccion"),t.qZA()(),t.TgZ(47,"div",14),t._UZ(48,"i",15),t.qZA()(),t.TgZ(49,"span",8),t._uU(50,"+30% "),t.qZA(),t.TgZ(51,"span",9),t._uU(52,"Probabilidad de mejorar"),t.qZA()()(),t.TgZ(53,"div",16)(54,"div",17)(55,"h5"),t._uU(56),t.qZA(),t.TgZ(57,"p-table",18),t.YNc(58,J,12,0,"ng-template",19)(59,O,11,4,"ng-template",20),t.qZA()(),t.TgZ(60,"div",17)(61,"h5"),t._uU(62,"Categor\xedas m\xe1s predichas"),t.qZA(),t.YNc(63,F,3,0,"div",21),t.TgZ(64,"div",22),t._UZ(65,"p-chart",23),t.qZA()()(),t.TgZ(66,"div",16)(67,"div",17)(68,"h5"),t._uU(69,"Metricas del modelo"),t.qZA(),t.TgZ(70,"div",24),t._UZ(71,"img",25),t.qZA()(),t.TgZ(72,"div",17)(73,"h5"),t._uU(74,"Predicciones Globales"),t.qZA(),t.TgZ(75,"p-table",18),t.YNc(76,j,12,0,"ng-template",19)(77,E,11,4,"ng-template",20),t.qZA()()(),t.TgZ(78,"p-dialog",26),t.NdJ("visibleChange",function(r){return n.displayModal=r}),t.YNc(79,N,1,1,"ng-template",27),t.qZA()()),2&o&&(t.xp6(9),t.Q6J("ngStyle",t.DdM(19,g)),t.xp6(14),t.Q6J("ngStyle",t.DdM(20,g)),t.xp6(10),t.Q6J("ngStyle",t.DdM(21,g)),t.xp6(14),t.Q6J("ngStyle",t.DdM(22,g)),t.xp6(9),t.hij("Tus predicciones recientes, ",null==n.user?null:n.user.name,""),t.xp6(1),t.Q6J("value",n.recentPredictions)("paginator",!0)("rows",5),t.xp6(6),t.Q6J("ngIf","Sin datos"===(null==n.chartData||null==n.chartData.labels?null:n.chartData.labels[0])),t.xp6(2),t.Q6J("data",n.chartData)("options",n.chartOptions),t.xp6(10),t.Q6J("value",n.allPredictions)("paginator",!0)("rows",5),t.xp6(3),t.Q6J("visible",n.displayModal)("header","Detalles de la Predicci\xf3n")("modal",!0)("closable",!0)("responsive",!0))},dependencies:[h.O5,h.PC,Z.C,u.iA,I.jx,u.lQ,u.fz,v.Hq,x.V],styles:['@charset "UTF-8";.chart-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;overflow-y:auto;margin-bottom:20px}.chart-wrapper[_ngcontent-%COMP%]   .p-chart[_ngcontent-%COMP%]{max-height:100%}@media (max-width: 768px){.chart-wrapper[_ngcontent-%COMP%]{height:300px}}']})}return i})(),Y=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[b.Bz.forChild([{path:"",component:B}]),b.Bz]})}return i})(),$=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[h.ez,T.u5,Z.S,A.$9,u.U$,U.l,y.ml,v.hJ,Y,x.S]})}return i})()}}]);